filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_discrete(c(-3,-2,1,0,1,2,3))
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_discrete(-3,-2,1,0,1,2,3)
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous(breaks= CKD_diff)
fal = -3:3
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous('CKD severity change from diagnosis to follow-up', breaks= fal)
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous('CKD severity change from diagnosis to follow-up', breaks= fal)+
ylab = 'Patient Count'
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous('CKD severity change from diagnosis to follow-up', breaks= fal)+
ylab('Patient Count')
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous('CKD severity change from diagnosis to follow-up', breaks= fal)+
ylab('Patient count')
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=1, vjust=1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=1, vjust=-1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-1, vjust=-1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-0.5, vjust=-1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-0.2, vjust=-1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-0.1, vjust=-1))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-0.1, vjust=-0.8))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001
", hjust=-0.1, vjust=-0.7))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001 ; n = 47
", hjust=-0.1, vjust=-0.7))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001 ; n = 47
", hjust=0, vjust=-0.7))
plot2
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001; n = 47
", hjust=0, vjust=-0.7))
plot2
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
group_by(CKD.stage...20) %>%
summarise(
n=n()
)
HNF1B_simple <- read_excel("C:/Coding/studentai/Lauryna/HNF1B_curated Nr.2.xlsx")
HNF1B_simple$diagnosis <- 1
HNF1B_simple$age_pre <- as.numeric(HNF1B_simple$age_pre)
HNF1B_simple$age_post <- as.numeric(HNF1B_simple$age_post)
HNF1B_simple <- HNF1B_simple %>%
mutate(mutacijos_tipas = ifelse(grepl('17q12', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), 'cdeletion', mutacijos_tipas))
HNF1B_simple<-HNF1B_simple %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == '3b (Schwartz)', '3.0', CKD.stage...7)) %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == 'IIIa', '3.0', CKD.stage...7)) %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == 'IIIb', '3.0', CKD.stage...7)) %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == '3a', '3.0', CKD.stage...7)) %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == '3b', '3.0', CKD.stage...7)) %>%
mutate(CKD.stage...7 = ifelse(CKD.stage...7 == '0.0', NA, CKD.stage...7)) %>%
mutate(CKD.stage...7 = as.numeric(CKD.stage...7))
HNF1B_simple <- HNF1B_simple %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == '3b (Schwartz)', '3.0', CKD.stage...20)) %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == 'IIIa', '3.0', CKD.stage...20)) %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == 'IIIb', '3.0', CKD.stage...20)) %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == '3a', '3.0', CKD.stage...20)) %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == '3b', '3.0', CKD.stage...20)) %>%
mutate(CKD.stage...20 = ifelse(CKD.stage...20 == '0.0', NA, CKD.stage...20)) %>%
mutate(CKD.stage...20 = as.numeric(CKD.stage...20))
HNF_grouped <- HNF1B_simple_nona %>%
mutate(frameshift = ifelse(grepl('frameshift', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), TRUE, FALSE)) %>%
mutate(deletion = ifelse(grepl('deletion', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), TRUE, FALSE)) %>%
mutate(missense = ifelse(grepl('missense', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), TRUE, FALSE)) %>%
mutate(nonsense = ifelse(grepl('nonsense|stop', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), TRUE, FALSE)) %>%
mutate(splice = ifelse(grepl('splice', HNF1B.mutation..localization..nucleotide.and.amino.acid.change., ignore.case = TRUE), TRUE, FALSE))
HNF1B_simple %>%
group_by(mutacijos_tipas) %>%
summarise(
n = n()
)
fit <- survfit(Surv(age_pre, diagnosis) ~ 1, data = HNF1B_simple_nona)
fit
fit %>%
ggsurvfit(type='risk') +
labs(
x = "Age at diagnosis",
y = "Cumulative Incidence"
)+
add_confidence_interval()+
add_risktable()
HNF1B_simple <- HNF1B_simple %>%
mutate(severe_post = ifelse(CKD.stage...20 == 5, 1, 0)) %>%
mutate(severe_pre = ifelse(CKD.stage...7 == 5, 1, 0))
fit <- survfit(Surv(age_post, severe_post) ~ 1, data = HNF1B_simple)
fit %>%
ggsurvfit() +
labs(
x = "AGE at follow-up",
y = "5th CKD stage probability"
)+
add_confidence_interval()+
add_risktable()
fit_mult <- survfit2(Surv(age_pre, diagnosis) ~ mutacijos_tipas, data = .)
HNF1B_simple %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
filter(!is.na(mutacijos_tipas)) %>%
fit_mult <- survfit2(Surv(age_pre, diagnosis) ~ mutacijos_tipas, data = .)
HNF1B_simple %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
filter(!is.na(mutacijos_tipas)) %>%
fit_mult <- survfit2(Surv(age_pre, diagnosis) ~ mutacijos_tipas, data = .data)
HNF1B_survival <- HNF1B_simple %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
filter(!is.na(mutacijos_tipas))
fit_mult <- survfit2(Surv(age_pre, diagnosis) ~ mutacijos_tipas, data = HNF1B_survival)
fit_mult %>%
ggsurvfit(type='risk', lwd=1) +
labs(
x = "Age at diagnosis",
y = "Cumulative Incidence"
)+
theme(legend.position = "right")
extract_element_end <- function(string) {
split_string <- strsplit(string, "[\\,]")
element <- split_string[[1]][1]
return(element)
}
HNF1B_simple$eGFR_pre <-as.numeric(lapply(HNF1B_simple$eGFR..mL.min.1.73m2....6, extract_element_end))
HNF1B_simple$eGFR_post <- as.numeric(lapply(HNF1B_simple$eGFR..mL.min.1.73m2....19, extract_element_end))
HNF1B_simple_prelm <- HNF1B_simple %>%
filter(!is.na(eGFR_pre)) %>%
filter(!is.na(age_pre))
r <- round(cor(HNF1B_simple_prelm$age_pre,HNF1B_simple_prelm$eGFR_pre), 2)
p <- cor.test(HNF1B_simple_prelm$age_pre,HNF1B_simple_prelm$eGFR_pre)$p.value
HNF1B_simple_prelm %>%
filter(!is.na(eGFR..mL.min.1.73m2....6)) %>%
select(age_pre, eGFR_pre) %>%
ggplot(aes(x=age_pre, y=eGFR_pre))+
geom_point()+
ylab('eGFR, UNITS')+
xlab('Age at diagnosis')+
geom_smooth(method = 'lm', formula = y~x, se=FALSE)+
annotate("text", x=40, y=150, label=paste0("r = ", r), hjust=0) +
annotate("text", x=40, y=140, label="p < 0.001", hjust=0)
HNF1B_simple_prelm %>%
filter(!is.na(eGFR..mL.min.1.73m2....6)) %>%
select(age_pre, eGFR_pre) %>%
ggplot(aes(x=age_pre, y=eGFR_pre))+
geom_point()+
ylab('eGFR, UNITS')+
xlab('Age at diagnosis')+
geom_smooth(method = 'lm', formula = y~x, se=FALSE)+
annotate("text", x=40, y=150, label=paste0("r = ", r), hjust=0) +
annotate("text", x=40, y=135, label="p < 0.001", hjust=0)
lm_fit <- lm(eGFR_pre ~ age_pre, data=HNF1B_simple)
summary(lm_fit)
lm_fit <- lm(eGFR_pre ~ age_pre + CKD.stage...7, data=HNF1B_simple)
summary(lm_fit)
HNF1B_simple_difflm <- HNF1B_simple %>%
filter(!is.na(eGFR_post)) %>%
filter(!is.na(age_pre)) %>%
filter(!is.na(age_post)) %>%
mutate(age_diff = age_post - age_pre)
r <- round(cor(HNF1B_simple_difflm$age_diff,HNF1B_simple_difflm$eGFR_post), 2)
p <- cor.test(HNF1B_simple_difflm$age_diff,HNF1B_simple_difflm$eGFR_post)$p.value
HNF1B_simple_difflm %>%
filter(!is.na(eGFR_post)) %>%
filter(!is.na(age_pre)) %>%
filter(!is.na(age_post)) %>%
select(age_diff, eGFR_post) %>%
ggplot(aes(x=age_diff, y=eGFR_post))+
geom_point()+
ylab('eGFR, UNITS')+
xlab('Years between diagnosis and follow-up')+
geom_smooth(method = 'lm', formula = y~x, se=FALSE)+
annotate("text", x=15, y=100, label=paste0("r = ", r), hjust=0) +
annotate("text", x=15, y=90, label="p = 0.001", hjust=0)
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication'))) %>%
na.omit() %>%
group_by(mutacijos_tipas) %>%
summarise(
n=n(),
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
)
bxp <- HNF1B_simple %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication'))) %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
ggboxplot(x='mutacijos_tipas', y='CKD.stage...7', fill='mutacijos_tipas')
bxp
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))+
theme_bw()
anova_data <- HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7)
aov.m <- aov(CKD.stage...7 ~ mutacijos_tipas, data=anova_data)
summary(aov.m)
tukey <- TukeyHSD(aov.m)
tukey
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
group_by(CKD.stage...7) %>%
summarise(
n=n()
)
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
group_by(CKD.stage...7) %>%
summarise(
n=n()
)
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
group_by(CKD.stage...20) %>%
summarise(
n=n()
)
set.seed(1)
pie.chart.data <- HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_pre = as.factor(CKD.stage...7)) %>%
mutate(CKD_post = as.factor(CKD.stage...20)) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_pre, CKD_post) %>%
pivot_longer(c(CKD_pre, CKD_post), names_to = 'CKD_time', values_to = 'CKD_stage')
mutate(CKD_time= as.factor(CKD_time))
pie.chart.data <- HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_pre = as.factor(CKD.stage...7)) %>%
mutate(CKD_post = as.factor(CKD.stage...20)) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_pre, CKD_post) %>%
pivot_longer(c(CKD_pre, CKD_post), names_to = 'CKD_time', values_to = 'CKD_stage') %>%
mutate(CKD_time= as.factor(CKD_time))
g1 <- ggpiestats(data = filter(pie.chart.data, CKD_time == 'CKD_pre'),
x=CKD_stage,
results.subtitle = FALSE,
label.repel = TRUE,
title='CKD at diagnosis',
label='both')
g2 <- ggpiestats(data = filter(pie.chart.data, CKD_time == 'CKD_post'),
x=CKD_stage,
results.subtitle = FALSE,
label.repel = TRUE,
title='CKD at follow-up',
label='both')
cqt <- CochranQTest(CKD_stage ~ CKD_time| Patient.ID, data=pie.chart.data)
plot1 <- ggarrange(g1, g2, ncol=2, nrow=1, common.legend = TRUE, legend='right')
plot2 <- annotate_figure(plot1, bottom = text_grob("Cochran's Q test: X\u00B2(1)=10.67, p = 0.001; n = 47
", hjust=0, vjust=-0.7))
plot2
cqt
plot2
fal = -3:3
HNF1B_simple %>%
filter(!(CKD.stage...7 == 0)) %>%
filter(!is.na(CKD.stage...7)) %>%
filter(!is.na(CKD.stage...20)) %>%
mutate(CKD_diff = CKD.stage...20-CKD.stage...7) %>%
mutate(mutacijos_tipas = as.factor(mutacijos_tipas)) %>%
select(Patient.ID, CKD_diff) %>%
ggplot(aes(CKD_diff))+
geom_bar()+
scale_x_continuous('CKD severity change from diagnosis to follow-up', breaks= fal)+
ylab('Patient count')
fit <- survfit(Surv(age_pre, diagnosis) ~ 1, data = HNF1B_simple)
fit
fit %>%
ggsurvfit(type='risk') +
labs(
x = "Age at diagnosis",
y = "Cumulative Incidence"
)+
add_confidence_interval()+
add_risktable()
anova_data <- HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7)
aov.m <- aov(CKD.stage...7 ~ mutacijos_tipas, data=anova_data)
summary(aov.m)
tukey <- TukeyHSD(aov.m)
tukey
tukey <- TukeyHSD(aov.m, which = c('wdeletion'))
tukey
?Tukey
install.packages('agricolae')
library(agricolae)
LSD <- LSD.test(aov.m,))
LSD <- LSD.test(aov.m)
LSD <- LSD.test(aov.m, 'mutacijos_tipas')
LSD
plot(LSD)
LSD
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))+
theme_bw()
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))
theme_set(theme_bw()+
theme(panel.grid = element_blank()))
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))
fit <- survfit(Surv(age_pre, diagnosis) ~ 1, data = HNF1B_simple)
fit %>%
ggsurvfit(type='risk') +
labs(
x = "Age at diagnosis",
y = "Cumulative Incidence"
)+
add_confidence_interval()+
add_risktable()
HNF1B_survival <- HNF1B_simple %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
filter(!is.na(mutacijos_tipas))
fit_mult <- survfit2(Surv(age_pre, diagnosis) ~ mutacijos_tipas, data = HNF1B_survival)
fit_mult %>%
ggsurvfit(type='risk', lwd=1) +
labs(
x = "Age at diagnosis",
y = "Cumulative Incidence"
)+
theme(legend.position = "right")
HNF1B_simple %>%
select(mutacijos_tipas, CKD.stage...7) %>%
filter(!(mutacijos_tipas %in% c(NA, 'insertion', 'heterozygous intragenic mutation', 'frameshift', 'duplication', '?deletion'))) %>%
na.omit() %>%
select(mutacijos_tipas, CKD.stage...7) %>%
group_by(mutacijos_tipas) %>%
summarise(
mean = mean(CKD.stage...7),
sd = sd(CKD.stage...7)
) %>%
ggplot(aes(x=mutacijos_tipas, y=mean, fill=mutacijos_tipas))+
geom_bar(stat = 'identity')+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9))
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni)
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni')
LSD
LSD$groups
plot(LSD)
LSD$groups
LSD$groups
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni', alpha=0.01)
LSD$groups
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni', alpha=0.05)
LSD$groups
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni', alpha=0.1)
LSD$groups
LSD <- LSD.test(aov.m, 'mutacijos_tipas', p.adj='bonferroni', alpha=0.05)
tukey <- TukeyHSD(aov.m)
tukey
summary(tukey)
TukeyHSD(aov.m)
